{% extends "base.html" %}

{% block content %}
<div style="padding: 20px 0;">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <h2>Dashboard</h2>
        <div>
            <a href="{{ url_for('logout') }}"
                style="color: red; margin-right: 15px; text-decoration: none; font-weight: 500;">Logout</a>
            <a href="{{ url_for('new_entry') }}" class="btn-primary" style="padding: 8px 12px; width: auto; margin:0;">+
                NEW</a>
        </div>
    </div>

    <div style="margin-bottom: 20px;">
        <a href="{{ url_for('download_excel') }}" class="btn-primary" style="background: #10B981;">Download Excel</a>
    </div>

    <div style="overflow-x: auto;">
        <table style="width: 100%; border-collapse: collapse; min-width: 600px;">
            <thead>
                <tr style="background: #F3F4F6; text-align: left;">
                    <th style="padding: 10px;">Date</th>
                    <th style="padding: 10px;">Company</th>
                    <th style="padding: 10px;">Emp ID</th>
                    <th style="padding: 10px;">Batch (Final)</th>
                    <th style="padding: 10px;">Type</th>
                    <th style="padding: 10px;">Urea %</th>
                    <th style="padding: 10px;">Density</th>
                    <th style="padding: 10px;">Photo</th>
                    <th style="padding: 10px;">Action</th>
                </tr>
            </thead>
            <tbody>
                {% for entry in entries %}
                <tr style="border-bottom: 1px solid #E5E7EB;">
                    <td style="padding: 10px;">{{ entry.timestamp.strftime('%Y-%m-%d %H:%M:%S') }}</td>
                    <td style="padding: 10px;">{{ entry.company_name }}<br><span
                            style="font-size: 0.8rem; color: gray;">{{ entry.authorised_person }}</span></td>
                    <td style="padding: 10px;">{{ entry.employee_id }}</td>
                    <td style="padding: 10px;">{{ entry.final_batch_number }}</td>
                    <td style="padding: 10px;">{{ entry.sf_batch_number }}</td>
                    <td style="padding: 10px;">{{ entry.urea_percentage }}</td>
                    <td style="padding: 10px;">{{ entry.density }}</td>
                    <td style="padding: 10px;">
                        {% if entry.photo_path %}
                        <a href="{{ url_for('uploaded_file', filename=entry.photo_path) }}" target="_blank">View</a>
                        {% else %}
                        -
                        {% endif %}
                    </td>
                    <td style="padding: 10px;">
                        <a href="{{ url_for('delete_entry', entry_id=entry.id) }}"
                            style="color: red; text-decoration: none; font-weight: 500;"
                            onclick="return confirm('Are you sure you want to delete this entry?')">Delete</a>
                    </td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="8" style="padding: 20px; text-align: center;">No entries found.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}